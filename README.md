# timeline
![1](https://user-images.githubusercontent.com/11984268/124024711-93ffe700-d9bd-11eb-83f8-0f383f096329.png)

The App is called Timeline simply because I use Google Map's timeline feature a lot and I really like it. 

So I made this Full Stack MERN Application with additional features from ReactMapGL and Mapbox, that allows users to log in and save the places they've visited.

### Development process
For the backend, I'm using MongoDB as database. For this application, there are 2 data models inside the DB: Users and Pins.

Needless to say, every user should have an email and password to login, to creat a new User, the following schema is applied:
```
const UserSchema = new mongoose.Schema(
	{
		username: {
			type: String,
			require: true,
			min: 3,
			max: 20,
			unique: true,
		},
		email: {
			type: String,
			require: true,
			max: 50,
			unique: true,
		},
		password: {
			type: String,
			require: true,
			min: 6,
		},
	},
	{ timestamps: true }
);
```


Once they logged in, they can create their own pin by double clicking anywhere on the map and enter the related infomations.
In this case, they need another data model which is the Pin Schema:

```
const PinSchema = new mongoose.Schema(
	{
		username: {
			type: String,
			require: true,
		},
		title: {
			type: String,
			require: true,
			min: 3,
		},
		desc: {
			type: String,
			require: true,
			min: 3,
		},
		rating: {
			type: Number,
			require: true,
			min: 0,
			max: 5,
		},
		lat: {
			type: Number,
			require: true,
		},
		long: {
			type: Number,
			require: true,
		},
	},
	{ timestamps: true }
);
```


This concludes all the info that a user can enter and save. For the users, there are 3 things for them to be filled: title, description and rating.
Other properties inside this schema like longitute and latitude will be auto generated by ReactmapGL after the double click.

The doubleclick function (onDblClick) comes with the ReactMapGL, to enable this feature as well as other features like map style, simply passing props into the "ReactMapGL" component.

	
```
<ReactMapGL
{...viewport}
mapStyle='mapbox://styles/xcg1234/ckpoby1jx0xt117phqtxc5hhb' // the colorful bright color theme as you can see in the app
mapboxApiAccessToken={process.env.REACT_APP_MAPBOX} // linked to the token in env file
onViewportChange={handleViewportChange}
onDblClick={handleAddClick}
ref={mapRef}
>	
```
By double clicking the map we call the function 'handleAddClick', that will take the latitude and longitude of the cursor location and passing the date to 'newPlace' variable.
	
```
//add location when dblclick and create a new "newPlace" which will also trigger popup
const handleAddClick = (e) => {
	const [long, lat] = e.lngLat;
	setNewPlace({
		lat,
		long,
	});
};
```
	
	
After a newPlace variable has been created, the "Popup" components comes with the ReactMapGL will show up and display the form that allows the user to enter the info.
	
	
```
{newPlace && (
					<Popup
						key={newPlace.createdAt}
						latitude={newPlace.lat}
						longitude={newPlace.long}
						closeButton={true}
						closeOnClick={false}
						anchor='top'
						onClose={() => {
							setNewPlace(null);
						}}
					>
						<div>
							<form onSubmit={handleSubmit}>
								<label>Title</label>
								<input
									type='text'
									placeholder='Enter the title'
									onChange={(e) => setTitle(e.target.value)}
								/>
								<label>Review</label>
								<textarea
									placeholder='Say something about the place.'
									onChange={(e) => setDesc(e.target.value)}
								/>
								<label>Rating</label>
								<select onChange={(e) => setRating(e.target.value)}>
									<option value='1'>1</option>
									<option value='2'>2</option>
									<option value='3'>3</option>
									<option value='4'>4</option>
									<option value='5'>5</option>
								</select>
								<button className='submitButton' type='submit'>
									Add Pin
								</button>
							</form>
						</div>
					</Popup>
```
	

![image](https://i.imgur.com/MWinRu1.png)

After the user logged in and saved their locations, the pin color of their own history will be orange color, and pins saved by other users are displayed as purple color.
